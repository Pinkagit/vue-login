webpackJsonp([1],{II5g:function(e,t){},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s("7+uW"),a={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]},n=s("VU/8")({name:"App"},a,!1,null,null,null).exports,o=s("/ocq"),i=s("NYxO");r.default.use(i.a);var l={TOKEN:window.sessionStorage.getItem("token")},u={LOGIN:function(e,t){e.TOKEN=t,window.sessionStorage.setItem("token",t)},LOGOUT:function(e,t){e.TOKEN=null,window.sessionStorage.removeItem("token")}},c=new i.a.Store({state:l,mutations:u,actions:{}}),p={data:function(){return{users:[]}},created:function(){var e=this;this.$ajax.getUserInfo().then(function(t){console.log(t),e.users=t.data.msg}).catch(function(e){console.log(e)})},methods:{del_user:function(e,t){var s=this;this.$ajax.delUser({id:t}).then(function(t){console.log(t),0===t.data.sta?s.$message.error(t.data.msg):(s.users.splice(e,1),s.$message.success(t.data.msg))}).catch(function(e){console.log(e)})},logout:function(){this.$store.commit("LOGOUT"),this.$router.push("/login")},totest:function(){this.$router.push("/test")}}},d={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("h1",[e._v("\n        hello!\n    ")]),e._v(" "),s("el-button",{on:{click:function(t){e.logout()}}},[e._v("退出")]),e._v(" "),s("ul",e._l(e.users,function(t,r){return s("li",{key:t._id},[e._v("\n            "+e._s(r+1)+"."+e._s(t.username)+"\n            "),s("el-button",{on:{click:function(s){e.del_user(r,t._id)}}},[e._v("注销用户")])],1)})),e._v(" "),s("el-button",{on:{click:function(t){e.totest()}}},[e._v("go test!")])],1)},staticRenderFns:[]},g=s("VU/8")(p,d,!1,null,null,null).exports,m={data:function(){var e=this;return{rules:{password:[{validator:function(t,s,r){""==s?r(new Error("please input password.")):(""!==e.registData.repassword&&e.$refs["re-form"].validateField("repassword"),r())},trigger:"blur"}],repassword:[{validator:function(t,s,r){""===s?r(new Error("please input password.")):s!==e.registData.password?r(new Error("The twice input is not in accord")):r()},trigger:"blur"}]},loginData:{username:"",password:""},registData:{username:"",password:"",repassword:""}}},methods:{Login:function(){var e=this;console.log("loginData:",this.loginData),this.$ajax.userLogin(this.loginData).then(function(t){console.log(t),0!==t.data.sta?(e.$message.success(t.data.msg),e.$store.commit("LOGIN",t.data.token),e.$router.push(e.$router.currentRoute.query.redirect)):e.$message.error(t.data.msg)}).catch(function(e){console.log(e)})},reset:function(){this.loginData.username="",this.loginData.password=""},Regist:function(){var e=this;console.log("registData:",this.registData),this.$ajax.userRegister(this.registData).then(function(t){console.log(t),0!==t.data.sta?e.$message.success(t.data.msg):e.$message.error(t.data.msg)}).catch(function(e){console.log(e)})}}},f={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("el-tabs",{staticClass:"box",attrs:{type:"border-card"}},[s("el-tab-pane",{attrs:{label:"login"}},[s("el-form",{ref:"form",attrs:{model:e.loginData,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"Username"}},[s("el-input",{model:{value:e.loginData.username,callback:function(t){e.$set(e.loginData,"username",t)},expression:"loginData.username"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Password"}},[s("el-input",{attrs:{type:"password"},model:{value:e.loginData.password,callback:function(t){e.$set(e.loginData,"password",t)},expression:"loginData.password"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.Login}},[e._v("登入")]),e._v(" "),s("el-button",{on:{click:e.reset}},[e._v("重置")])],1)],1)],1),e._v(" "),s("el-tab-pane",{attrs:{label:"regist"}},[s("el-form",{ref:"re-form",attrs:{"status-icon":"",model:e.registData,"label-width":"80px",rules:e.rules}},[s("el-form-item",{attrs:{label:"Username"}},[s("el-input",{model:{value:e.registData.username,callback:function(t){e.$set(e.registData,"username",t)},expression:"registData.username"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"password",prop:"password"}},[s("el-input",{attrs:{type:"password"},model:{value:e.registData.password,callback:function(t){e.$set(e.registData,"password",t)},expression:"registData.password"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"repassword",prop:"repassword"}},[s("el-input",{attrs:{type:"password"},model:{value:e.registData.repassword,callback:function(t){e.$set(e.registData,"repassword",t)},expression:"registData.repassword"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.Regist}},[e._v("注册")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var h=s("VU/8")(m,f,!1,function(e){s("II5g")},null,null).exports,v={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("p",[e._v("test")]),e._v("\n    "+e._s(e.users)+"\n\n    "),s("el-button",{on:{click:function(t){e.tohome()}}},[e._v("返回")])],1)},staticRenderFns:[]},w=s("VU/8")({data:function(){return{users:[]}},created:function(){var e=this;this.$ajax.getUserInfo().then(function(t){e.users=t.data.msg})},methods:{tohome:function(){this.$router.push("/")}}},v,!1,null,null,null).exports;r.default.use(o.a);var _=new o.a({routes:[{path:"/",name:"home",component:g,meta:{requiresAuth:!0}},{path:"/hello",name:"hello",component:g},{path:"/login",name:"login",component:h},{path:"/test",name:"test",component:w,meta:{requiresAuth:!0}}]});_.beforeEach(function(e,t,s){var r=c.state.TOKEN;console.log("To",e,r),e.meta.requiresAuth?r?s():s({path:"/login",query:{redirect:e.fullPath}}):s()});var b=_,D=s("//Fk"),$=s.n(D),k=s("mtWM"),x=s.n(k).a.create({timeout:1e4,headers:{"Content-Type":"application/json;charset=UTF-8"}});x.interceptors.request.use(function(e){return c.state.TOKEN&&(e.headers.Authorization="token "+c.state.TOKEN),e}),x.interceptors.response.use(function(e){return e},function(e){if(e.response)switch(console.log("fullPath:",b.currentRoute.fullPath),e.response.status){case 401:c.commit("LOGOUT"),b.replace({path:"login",query:{redirect:b.currentRoute.fullPath}})}return $.a.reject(e.response)});var O={userLogin:function(e){return x.post("/api/login",e)},userRegister:function(e){return x.post("/api/register",e)},getUserInfo:function(){return x.get("/api/getuserinfo")},delUser:function(e){return x.post("/api/deluser",e)}},y=s("zL8q"),U=s.n(y);s("tvR6");r.default.use(U.a),r.default.config.productionTip=!1,r.default.prototype.$ajax=O,new r.default({el:"#app",router:b,store:c,components:{App:n},template:"<App/>"})},tvR6:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.e42759beb6c70d965460.js.map